<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Survivor’s Radio — Overwatch Zombies</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=Oxanium:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --ow-orange:#f9a51a;
      --ow-orange-2:#ffb547;
      --ow-blue:#00a7e0;
      --ow-dark:#0f1216;
      --ow-dark-2:#161a21;
      --ow-card:#151a22;
      --ow-line:#232a34;
      --ow-text:#e8edf2;
      --ow-dim:#9aa3ad;
      --shadow: 0 8px 30px rgba(0,0,0,.35);
      --radius: 16px;
      --gap: 22px;
      --max: 1100px;
      --nav-h: 74px;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--ow-dark);color:var(--ow-text)}
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;line-height:1.6;padding-top:var(--nav-h)}
    h1,h2{font-family:Oxanium,Inter,sans-serif;line-height:1.15;letter-spacing:.3px;margin:0 0 .6em}
    a{color:var(--ow-blue);text-decoration:none}
    a:hover{text-decoration:underline}

    /* ==== NAV (same pattern as your site) ==== */
    .nav{position:fixed;inset:0 0 auto 0;height:var(--nav-h);z-index:9999;display:flex;align-items:center;justify-content:center;
      backdrop-filter: blur(10px);
      background: linear-gradient(180deg, rgba(15,18,22,.75), rgba(15,18,22,.45));
      border-bottom:1px solid var(--ow-line);}
    .nav__inner{width:100%;max-width:var(--max);padding:0 16px;display:flex;align-items:center;justify-content:space-between;gap:16px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:800;letter-spacing:.5px}
    .brand__logo{width:34px;height:34px;border-radius:50%;
      background: radial-gradient(90% 90% at 30% 30%, var(--ow-orange), #ff7a00);
      box-shadow: inset 0 0 0 2px #111, 0 4px 12px rgba(0,0,0,.35)}
    .brand__name{color:#fff}
    .nav__links{display:flex;gap:18px;align-items:center;flex-wrap:wrap}
    .chip{color:#fff;font-weight:700;padding:10px 14px;border-radius:999px;background:transparent;border:1px solid transparent;
      transition:.2s transform ease,.2s background ease,.2s border-color ease;text-decoration:none;white-space:nowrap}
    .chip:hover{transform:translateY(-1px)}
    .chip--gold{border-color:#2a2f39;background:linear-gradient(180deg,#1b212a,#151a22)}
    .chip--gold:hover{border-color:#3a414e;background:linear-gradient(180deg,#202735,#161c25)}
    .chip--cta{background:linear-gradient(180deg,var(--ow-orange),var(--ow-orange-2));color:#111;box-shadow:0 8px 20px rgba(249,165,26,.35)}
    .chip--cta:hover{transform:translateY(-1px) scale(1.02)}
    .nav__toggle{display:none}
    .nav__btn{display:none;width:42px;height:42px;border-radius:10px;border:1px solid #2b3240;background:linear-gradient(180deg,#1b212a,#151a22);
      color:#fff;align-items:center;justify-content:center;cursor:pointer;transition:.2s transform ease}
    .nav__btn:hover{transform:translateY(-1px)}
    .nav__icon{width:22px;height:22px;display:block}
    .nav__panel{display:none;position:fixed;top:var(--nav-h);left:0;right:0;background:linear-gradient(180deg,#12161d,#0e131a);
      border-bottom:1px solid var(--ow-line);box-shadow:var(--shadow);padding:12px 16px 16px}
    .nav__panel .chip{display:block;text-align:center;margin:8px 0;padding:12px 16px;font-size:16px}
    .nav__toggle:checked ~ .nav__panel{display:block}
    @media (max-width:1100px){.nav__links{display:none}.nav__btn{display:flex}}

    /* ==== LAYOUT WRAP (keep your padding rules) ==== */
    .wrap{max-width:var(--max);margin:0 auto;padding:clamp(28px,4vw,40px);padding-left:48px;padding-right:48px}

    /* ==== Page Header Card ==== */
    .card{
      background:linear-gradient(180deg,#12161d,#0f141b);
      border:1px solid var(--ow-line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:clamp(18px,3vw,26px);
    }
    .muted{color:var(--ow-dim)}

    /* ==== Playlist Layout ==== */
    .playlist{
      margin-top:18px;
      background:linear-gradient(180deg,#11161d,#0e131a);
      border:1px solid var(--ow-line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }
    .plist__header{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      padding:14px 16px;border-bottom:1px solid var(--ow-line);
      background:linear-gradient(180deg,#171c24,#12161c);
    }
    .plist__search{
      flex:1 1 auto;max-width:360px;
      background:#0f141b;border:1px solid #2b3240;color:#e8edf2;
      border-radius:10px;padding:10px 12px;outline:none;
    }
    .plist__cols{
      display:grid;grid-template-columns:48px 1fr 120px 72px;gap:12px;
      padding:10px 16px;color:#9aa3ad;font-weight:600;font-size:12px;letter-spacing:.2px;
      border-bottom:1px solid var(--ow-line);
    }
    @media (max-width:600px){
      .plist__cols{grid-template-columns:44px 1fr 70px 60px}
    }

    .plist__scroller{
      max-height:520px;overflow:auto;
      scrollbar-width:thin;scrollbar-color:#2b3442 transparent;
    }
    .plist__scroller::-webkit-scrollbar{height:12px;width:12px}
    .plist__scroller::-webkit-scrollbar-thumb{background:#2b3442;border-radius:12px}
    .plist__scroller::-webkit-scrollbar-track{background:transparent}

    .row{
      display:grid;grid-template-columns:48px 1fr 120px 72px;gap:12px;
      align-items:center;padding:10px 16px;border-bottom:1px solid rgba(35,42,52,.55);
      transition:background .2s ease;
    }
    @media (max-width:600px){
      .row{grid-template-columns:44px 1fr 70px 60px}
    }
    .row:hover{background:#141a22}
    .row.active{background:#161d27}
    .row__play{
      display:flex;align-items:center;justify-content:center;
      width:36px;height:36px;border-radius:10px;border:1px solid #2b3240;
      background:linear-gradient(180deg,#1b212a,#151a22);cursor:pointer;
    }
    .row__title{font-weight:700}
    .row__meta{color:var(--ow-dim);font-size:12px}
    .row__tag{
      display:inline-flex;align-items:center;gap:8px;padding:6px 10px;border-radius:999px;
      border:1px solid #2b3240;background:#121721;color:#c6cdd6;font-size:12px;justify-self:start
    }
    .row__dur{justify-self:end;color:#cbd3dc;font-variant-numeric:tabular-nums}

    /* ==== Sticky Player Controls ==== */
    .player{
      position:sticky;bottom:0;z-index:5;
      background:linear-gradient(180deg,#0f141b,#0c1117);
      border-top:1px solid var(--ow-line);
      padding:12px 16px;display:grid;gap:12px;
      grid-template-columns:1fr auto 1fr;align-items:center;
    }
    @media (max-width:720px){
      .player{grid-template-columns:1fr}
    }
    .controls{display:flex;align-items:center;gap:8px;justify-content:center}
    .btn{
      display:inline-flex;align-items:center;justify-content:center;
      width:38px;height:38px;border-radius:10px;border:1px solid #2b3240;
      background:linear-gradient(180deg,#1b212a,#151a22);color:#fff;cursor:pointer;
      transition:.2s transform ease;
    }
    .btn:hover{transform:translateY(-1px)}
    .btn--primary{background:linear-gradient(180deg,var(--ow-orange),var(--ow-orange-2));color:#111;box-shadow:0 8px 18px rgba(249,165,26,.28)}
    .trackinfo{min-width:0}
    .trackinfo__title{font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .trackinfo__meta{color:var(--ow-dim);font-size:12px}
    .timebar{display:flex;align-items:center;gap:8px}
    .time{font-variant-numeric:tabular-nums;color:#cfd7df;font-size:12px}
    .seek{appearance:none;width:100%;height:6px;border-radius:999px;background:#1a2230;outline:none}
    .seek::-webkit-slider-thumb{appearance:none;width:14px;height:14px;border-radius:50%;background:var(--ow-orange);cursor:pointer}
    .vol{display:flex;align-items:center;gap:8px;justify-content:flex-end}
    .vol__range{appearance:none;width:140px;height:6px;border-radius:999px;background:#1a2230;outline:none}
    .vol__range::-webkit-slider-thumb{appearance:none;width:14px;height:14px;border-radius:50%;background:#7fc8ff;cursor:pointer}
  </style>
</head>
<body>
  <!-- NAV -->
  <header class="nav">
    <div class="nav__inner">
      <div class="brand">
        <div class="brand__logo" aria-hidden="true"></div>
        <div class="brand__name">Overwatch: Zombies</div>
      </div>
      <label for="nav-toggle" class="nav__btn" aria-label="Open menu">
        <svg class="nav__icon" viewBox="0 0 24 24" fill="currentColor"><path d="M3 6h18v2H3V6Zm0 5h18v2H3v-2Zm0 5h18v2H3v-2Z"/></svg>
      </label>
      <input type="checkbox" id="nav-toggle" class="nav__toggle" aria-hidden="true">
      <nav class="nav__links" aria-label="Primary">
        <a class="chip chip--gold" href="index.html">Home</a>
        <a class="chip chip--gold" href="comics.html">Comics</a>
        <a class="chip chip--gold" href="mapcodes.html">Map Codes</a>
        <a class="chip chip--gold" href="wiki.html">Wiki</a>
        <a class="chip chip--gold" href="radio.html">Survivor’s Radio</a>
        <a class="chip chip--gold" href="credits.html">Credits</a>
        <a class="chip chip--cta" href="donations.html">Donations</a>
      </nav>
      <nav class="nav__panel" aria-label="Mobile menu">
        <a class="chip chip--gold" href="index.html"     onclick="document.getElementById('nav-toggle').checked=false">Home</a>
        <a class="chip chip--gold" href="comics.html"    onclick="document.getElementById('nav-toggle').checked=false">Comics</a>
        <a class="chip chip--gold" href="mapcodes.html"  onclick="document.getElementById('nav-toggle').checked=false">Map Codes</a>
        <a class="chip chip--gold" href="wiki.html"      onclick="document.getElementById('nav-toggle').checked=false">Wiki</a>
        <a class="chip chip--gold" href="radio.html" onclick="document.getElementById('nav-toggle').checked=false">Survivor’s Radio</a>
        <a class="chip chip--gold" href="credits.html"   onclick="document.getElementById('nav-toggle').checked=false">Credits</a>
        <a class="chip chip--cta"  href="donations.html" onclick="document.getElementById('nav-toggle').checked=false">Donations</a>
      </nav>
    </div>
  </header>

  <!-- HEADER -->
  <div class="wrap">
    <h1>Survivor’s Radio</h1>
    <div class="card">
      <p class="muted">A curated, map‑ready playlist for <strong>Zombies: Desecration</strong>. Hit play and let the radio run while you fight through the trials.</p>
    </div>

    <!-- PLAYLIST -->
    <div class="playlist" id="playlist">
      <div class="plist__header">
        <input id="search" class="plist__search" type="search" placeholder="Search tracks, maps, vibes…" aria-label="Search playlist">
        <div class="muted" style="font-weight:700">Total: <span id="count">0</span></div>
      </div>
      <div class="plist__cols">
        <div>#</div>
        <div>Title</div>
        <div>Map / Tag</div>
        <div>Length</div>
      </div>
      <div class="plist__scroller" id="rows"></div>

      <!-- STICKY PLAYER -->
      <div class="player">
        <div class="trackinfo">
          <div class="trackinfo__title" id="ti-title">—</div>
          <div class="trackinfo__meta" id="ti-meta">—</div>
        </div>

        <div class="controls" aria-label="Playback controls">
          <button class="btn" id="prev" title="Previous" aria-label="Previous">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M6 6h2v12H6zM9 12l11 7V5z"/></svg>
          </button>
          <button class="btn btn--primary" id="play" title="Play/Pause" aria-label="Play or pause">
            <svg id="icon-play" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg>
          </button>
          <button class="btn" id="next" title="Next" aria-label="Next">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M16 6h2v12h-2zM4 12l11 7V5z"/></svg>
          </button>
        </div>

        <div class="timebar">
          <span class="time" id="tcur">0:00</span>
          <input type="range" class="seek" id="seek" min="0" max="100" value="0" step="0.1" aria-label="Seek">
          <span class="time" id="ttot">0:00</span>
        </div>

        <div class="vol">
          <button class="btn" id="mute" title="Mute/Unmute" aria-label="Mute or unmute">
            <svg id="icon-vol" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M5 9v6h4l5 5V4L9 9H5z"/></svg>
          </button>
          <input type="range" class="vol__range" id="vol" min="0" max="1" step="0.01" aria-label="Volume">
        </div>
      </div>
    </div>
  </div>

  <footer style="padding:40px 0;color:var(--ow-dim);text-align:center">
    © <span id="y"></span> Zombies: Desecration • Survivor’s Radio
  </footer>

  <script>
    // Footer year
    document.getElementById('y').textContent = new Date().getFullYear();

    // Close mobile panel if resized up
    window.addEventListener('resize', () => {
      if (window.innerWidth > 1100) {
        const cb = document.getElementById('nav-toggle');
        if (cb) cb.checked = false;
      }
    });

    // ===== PLAYLIST DATA =====
    // Replace src with your real files (keep filenames web-safe)
    const TRACKS = [
      { id: 1, title: "Temple Ruins Descent", map: "Shambali Monastery", tag: "Fight", dur: "3:12", src: "assets/audio/temple-descent.mp3" },
      { id: 2, title: "Battle at the Temple", map: "Temple of Anubis", tag: "Fight", dur: "3:54", src: "assets/audio/battle-temple.mp3" }
    ];

    // ===== DOM HOOKS =====
    const rowsEl = document.getElementById('rows');
    const countEl = document.getElementById('count');
    const searchEl = document.getElementById('search');

    const playBtn = document.getElementById('play');
    const prevBtn = document.getElementById('prev');
    const nextBtn = document.getElementById('next');
    const iconPlay = document.getElementById('icon-play');

    const seek = document.getElementById('seek');
    const tcur = document.getElementById('tcur');
    const ttot = document.getElementById('ttot');

    const vol = document.getElementById('vol');
    const muteBtn = document.getElementById('mute');
    const iconVol = document.getElementById('icon-vol');

    const tiTitle = document.getElementById('ti-title');
    const tiMeta  = document.getElementById('ti-meta');

    // ===== AUDIO ENGINE =====
    const audio = new Audio();
    audio.preload = 'metadata';

    let queue = [...TRACKS];
    let filtered = [...TRACKS];
    let index = 0;
    let isPlaying = false;

    // Restore volume & mute
    let savedVol = parseFloat(localStorage.getItem('sr_volume'));
    if (isFinite(savedVol)) audio.volume = savedVol;
    else audio.volume = 0.8;

    let savedMuted = localStorage.getItem('sr_muted') === 'true';
    audio.muted = savedMuted;
    vol.value = audio.volume;
    updateMuteIcon();

    function fmtTime(s){
      if (!isFinite(s) || s < 0) return "0:00";
      const m = Math.floor(s/60);
      const r = Math.floor(s%60);
      return m + ":" + String(r).padStart(2,'0');
    }

    function setNowPlaying(track){
      tiTitle.textContent = track.title;
      tiMeta.textContent  = track.map + (track.tag ? " • " + track.tag : "");
      // Media Session (if supported)
      try {
        if ('mediaSession' in navigator){
          navigator.mediaSession.metadata = new MediaMetadata({
            title: track.title,
            artist: 'Zombies: Desecration',
            album: track.map,
            artwork: [{ src: 'assets/cover.jpg', sizes: '512x512', type: 'image/jpeg' }]
          });
          navigator.mediaSession.setActionHandler('play',  play);
          navigator.mediaSession.setActionHandler('pause', pause);
          navigator.mediaSession.setActionHandler('previoustrack', prev);
          navigator.mediaSession.setActionHandler('nexttrack', next);
          navigator.mediaSession.setActionHandler('seekbackward', () => { audio.currentTime = Math.max(audio.currentTime - 10, 0); });
          navigator.mediaSession.setActionHandler('seekforward', () => { audio.currentTime = Math.min(audio.currentTime + 10, audio.duration||0); });
        }
      } catch(e){}
    }

    function load(i){
      index = i;
      const track = filtered[index];
      if (!track) return;
      audio.src = track.src;
      audio.load();
      setNowPlaying(track);
      highlightRow(track.id);
    }

    function play(){
      if (!filtered.length) return;
      if (!audio.src) load(0);
      audio.play().then(() => {
        isPlaying = true;
        iconPlay.innerHTML = '<rect x="6" y="5" width="4" height="14"></rect><rect x="14" y="5" width="4" height="14"></rect>';
      }).catch(()=>{ /* autoplay blocked until user gesture */ });
    }
    function pause(){
      audio.pause();
      isPlaying = false;
      iconPlay.innerHTML = '<path d="M8 5v14l11-7z"/>';
    }
    function togglePlay(){ isPlaying ? pause() : play(); }

    function next(){
      if (!filtered.length) return;
      load((index + 1) % filtered.length);
      play();
    }
    function prev(){
      if (!filtered.length) return;
      load((index - 1 + filtered.length) % filtered.length);
      play();
    }

    function updateMuteIcon(){
      iconVol.innerHTML = audio.muted
        ? '<path d="M5 9v6h4l5 5V4L9 9H5zM19 5l-3 3m0 8 3 3" />'
        : '<path d="M5 9v6h4l5 5V4L9 9H5z"/>';
    }

    // Seek & time
    audio.addEventListener('timeupdate', () => {
      if (!audio.duration) return;
      seek.value = (audio.currentTime / audio.duration) * 100;
      tcur.textContent = fmtTime(audio.currentTime);
    });
    audio.addEventListener('loadedmetadata', () => {
      ttot.textContent = fmtTime(audio.duration);
      tcur.textContent = fmtTime(0);
      seek.value = 0;
    });
    audio.addEventListener('ended', next);

    seek.addEventListener('input', () => {
      if (!audio.duration) return;
      audio.currentTime = (seek.value / 100) * audio.duration;
    });

    // Volume + mute persistence
    vol.addEventListener('input', () => {
      audio.volume = parseFloat(vol.value);
      localStorage.setItem('sr_volume', audio.volume);
      if (audio.volume > 0 && audio.muted){
        audio.muted = false;
        localStorage.setItem('sr_muted', 'false');
        updateMuteIcon();
      }
    });
    muteBtn.addEventListener('click', () => {
      audio.muted = !audio.muted;
      localStorage.setItem('sr_muted', audio.muted ? 'true' : 'false');
      updateMuteIcon();
    });

    // Buttons
    playBtn.addEventListener('click', togglePlay);
    nextBtn.addEventListener('click', next);
    prevBtn.addEventListener('click', prev);

    // Keyboard shortcuts
    window.addEventListener('keydown', (e) => {
      const el = document.activeElement;
      const typing = el && (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA' || el.isContentEditable);
      if (typing) return;

      if (e.code === 'Space'){ e.preventDefault(); togglePlay(); }
      if (e.code === 'ArrowRight'){ audio.currentTime = Math.min((audio.currentTime||0)+5, audio.duration||0); }
      if (e.code === 'ArrowLeft'){ audio.currentTime = Math.max((audio.currentTime||0)-5, 0); }
      if (e.code === 'ArrowUp'){ e.preventDefault(); vol.value = Math.min(1, (parseFloat(vol.value)||0)+0.05); vol.dispatchEvent(new Event('input')); }
      if (e.code === 'ArrowDown'){ e.preventDefault(); vol.value = Math.max(0, (parseFloat(vol.value)||0)-0.05); vol.dispatchEvent(new Event('input')); }
    });

    // ==== RENDER ROWS ====
    function render(list){
      rowsEl.innerHTML = '';
      list.forEach((t, i) => {
        const row = document.createElement('div');
        row.className = 'row';
        row.dataset.id = t.id;

        row.innerHTML = `
          <div class="row__play" title="Play">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
              <path d="M8 5v14l11-7z"/>
            </svg>
          </div>
          <div>
            <div class="row__title">${t.title}</div>
            <div class="row__meta">${t.map}</div>
          </div>
          <div><span class="row__tag">${t.tag || '—'}</span></div>
          <div class="row__dur">${t.dur || '—'}</div>
        `;

        const playCell = row.querySelector('.row__play');
        playCell.addEventListener('click', () => {
          const newIdx = filtered.findIndex(x => x.id === t.id);
          if (newIdx !== -1){
            if (index === newIdx && isPlaying){
              pause();
            } else {
              load(newIdx);
              play();
            }
          }
        });

        row.addEventListener('dblclick', () => {
          const newIdx = filtered.findIndex(x => x.id === t.id);
          if (newIdx !== -1){ load(newIdx); play(); }
        });

        rowsEl.appendChild(row);
      });
      countEl.textContent = list.length;
      highlightRow(filtered[index]?.id);
    }

    function highlightRow(id){
      [...rowsEl.children].forEach(ch => ch.classList.toggle('active', String(ch.dataset.id) === String(id)));
    }

    // Search filter
    function applyFilter(){
      const q = (searchEl.value || '').toLowerCase().trim();
      filtered = queue.filter(t => 
        t.title.toLowerCase().includes(q) ||
        (t.map||'').toLowerCase().includes(q) ||
        (t.tag||'').toLowerCase().includes(q)
      );
      // keep index in bounds
      if (!filtered.length){ rowsEl.innerHTML = '<div style="padding:18px;color:#9aa3ad">No results.</div>'; countEl.textContent = '0'; return; }
      if (!filtered.includes(queue[index])) index = 0;
      render(filtered);
    }
    searchEl.addEventListener('input', applyFilter);

    // Initial render
    render(filtered);
    if (filtered[0]) { load(0); }

  </script>
</body>
</html>
